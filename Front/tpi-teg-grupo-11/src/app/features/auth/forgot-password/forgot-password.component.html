<main class="flex items-center justify-center min-h-screen">
  <button routerLink="/home" class="absolute left-5 top-5">Volver</button>
  <div class="background-container bg-cover bg-center p-15 rounded-2xl w-full max-w-sm"
       style="background-image: url('/assets/images/game/elements/register.png')">
    <h2 class="text-3xl font-bold text-center mb-6">Recuperar contraseña</h2>

    @if(!codigoEnviado){
      <form #recoveryForm="ngForm" (ngSubmit)="onSubmit(recoveryForm)" class="flex flex-col gap-2 justify-center">
        <div class="mb-4">
          <label class="block text-lg font-medium mb-1">Username</label>
          <input
            name="username"
            [(ngModel)]="data.username"
            #username="ngModel"
            type="text"
            class="input-fixed-width px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
            style="max-width: 280px;"
          />
        </div>
        <div class="mb-4">
          <label class="block text-lg font-medium mb-1">Email</label>
          <input
            name="email"
            [(ngModel)]="data.email"
            #email="ngModel"
            type="email"
            class="input-fixed-width px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
            style="max-width: 280px;"
          />
        </div>

        <button type="submit" class="m-auto">Enviar correo de restauración</button>
      </form>
    } @else {
      <form #receiveCode="ngForm" (ngSubmit)="onResetPassword(receiveCode)" class="flex flex-col gap-2 justify-center">
        <div class="mb-4">
          <label class="block text-lg font-medium mb-1">Codigo</label>
          <input
            name="code"
            [(ngModel)]="data.code"
            #code="ngModel"
            type="text"
            class="input-fixed-width px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
            style="max-width: 280px;"
          />
        </div>
        <div class="mb-4">
          <label class="block text-lg font-medium mb-1">Nueva Contraseña</label>
          <input
            name="newPassword"
            [(ngModel)]="data.newPassword"
            #newPassword="ngModel"
            [type]="showPassword ? 'text' : 'password'"
            class="input-fixed-width px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
            style="max-width: 280px;"
          />
          <button
            type="button"
            (click)="showPassword = !showPassword"
            class="flex items-center justify-center h-8 w-8"
            style="all: unset; cursor: pointer;"
          >
            @if (!showPassword) {
              <img
                src="/assets/images/game/elements/icon-hide.png"
                alt="Mostrar"
                class="h-5 w-5 pointer-events-none"
              />
            } @else {
              <img
                src="/assets/images/game/elements/icon-show.png"
                alt="Ocultar"
                class="h-5 w-5 pointer-events-none"
              />
            }
          </button>
        </div>

        <button type="submit" class="m-auto">Cambiar contraseña</button>
      </form>
    }

    @if(errorMessage) {
      <div class="mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded">
        {{ errorMessage }}
      </div>
    }

    <div class="flex justify-center mt-6 text-sm">
      <a routerLink="/login" class="text-blue-600 hover:underline cursor-pointer">Volver al inicio de sesión</a>
    </div>
  </div>
</main>
