<main appSession (sessionFound)="handleUser($event)" class="flex items-center justify-center min-h-screen max-w-screen">
  <button routerLink="/home" class="absolute left-5 top-5">Volver</button>
  <div class="background-container bg-cover bg-center p-15 rounded-2xl flex flex-col justify-center gap-5"
       style="background-image: url('/assets/images/game/elements/register.png')">
    <h1 class="mx-auto text-5xl">Match Lobby</h1>
    <form>
      <div class="grid grid-cols-2 grid-rows-3 gap-5 my-10 mx-5 justify-items-center">
        @for (player of players; track $index) {
          <div class="border-amber-800 bg-amber-700 border-2 rounded-md w-[120px] h-[60px] relative flex justify-center items-end">

            @if (player.playerType.toString() === 'BOT') {
              <!-- BOT -->
              <div class="z-10 absolute -top-3 left-1/2 -translate-x-1/2 rounded-full w-[30px] h-[30px] flex items-center justify-center">
                <mat-icon class="text-white">smart_toy</mat-icon>
              </div>
              <div
                class="z-9 absolute -top-3 left-1/2 -translate-x-1/2 rounded-full w-[30px] h-[30px] flex items-center justify-center bg-cover bg-center"
                [ngClass]="{
                    'bg-green-700': player.difficulty!.toString() === 'EASY',
                    'bg-yellow-600': player.difficulty!.toString() === 'MEDIUM',
                    'bg-red-700': player.difficulty!.toString() === 'HARD'
                  }">
              </div>
              <h2 class="text-2xl flex text-white">BOT {{ $index }}</h2>

            }
            @else if ((session?.username && player.user?.username === session!.username)) {
              <!-- Usuario actual -->
              <div
                class="z-10 absolute -top-3 left-1/2 -translate-x-1/2 rounded-full w-[30px] h-[30px] bg-amber-700 flex items-center justify-center bg-cover bg-center"
                [ngStyle]="{
                    'background-image': 'url(' + '\'' + player.user!.imgUrl + '\'' + ')',
                    'background-position': 'center 10%'
                  }"
              >
              </div>
              <h2 class="text-2xl flex text-white">Tú</h2>

            }
            @else if(player.playerType.toString() === 'PLAYER' && player.user?.username !== session?.username) {
              <div
                class="z-10 absolute -top-3 left-1/2 -translate-x-1/2 rounded-full w-[30px] h-[30px] bg-amber-700 flex items-center justify-center bg-cover bg-center"
                [ngStyle]="{
                    'background-image': 'url(' + '\'' + player.user!.imgUrl + '\'' + ')',
                    'background-position': 'center 10%'
                  }"
              >
              </div>
              <h2 class="text-2xl flex text-white">{{player.user?.username}}</h2>
            }
            @else {
              <!-- Invitado -->
              <div>
                <div class="z-10 absolute -top-3 left-1/2 -translate-x-1/2 rounded-full w-[30px] h-[30px] bg-amber-700 flex items-center justify-center">
                  <mat-icon class="text-white">person</mat-icon>
                </div>
                <div class="absolute -top-3 left-1/2 -translate-x-1/2 bg-amber-800 rounded-full w-[30px] h-[30px]"></div>
              </div>

              <h2 class="text-2xl flex text-white">Invitado</h2>
            }

          </div>
            <!-- Casilla libre
            <div class="border-amber-800 bg-black border-2 rounded-md w-[120px] h-[60px] relative flex justify-center items-end">
              <h2 class="text-white text-xl">Libre</h2>
            </div> -->
        }
      </div>

      <div class="flex gap-5 w-full justify-center">
        <button (click)="addBot(botSelected.difficult)">Añadir bot</button>
        <select name="botDifficulty" [(ngModel)]="botSelected.difficult" class="bg-white m-auto rounded-md py-2 px-2 pr-6 text-sm">
          @for (entry of botDifficultyEntries; track entry[0]) {
            <option [value]="entry[0]">{{ entry[1] }}</option>
          }
        </select>
      </div>
    </form>

    <div class="flex w-full justify-center">
      <button (click)="initGame(players)">Jugar</button>
    </div>
  </div>
</main>
